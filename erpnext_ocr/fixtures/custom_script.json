[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Invoice", 
  "modified": "2018-01-23 05:01:57.640664", 
  "name": "Sales Invoice-Client", 
  "script": "function copyToClipboard(id) {\n    console.log(id);\n    console.log(id);\n    console.log(id);\n    var copyText = document.getElementById(id);\n    /* Select the text field */\n  copyText.select();\n\n  /* Copy the text inside the text field */\n  document.execCommand(\"Copy\");\n\n}\n\nfrappe.ui.form.on('Sales Invoice', 'ocr_receipt',\n    function(frm){\n\n    console.log('OCR RECEIPT');\n\n    });\n\n\nfrappe.ui.form.on('Sales Invoice', {\n    // validate:function (frm) {\n    //\n    // },\n\n    refresh: function (frm) {\n\n        cur_frm.add_custom_button(__('OCR'),\n            function () {\n\n\n                if (cur_frm.doc.ocr_receipt) {\n                    var d = new frappe.ui.Dialog({\n                        'fields': [\n                            // {'fieldname': 'ocr_receipt', 'fieldtype': 'Link','options':'OCR Receipt', 'label': 'OCR Receipt', 'reqd': 1} ,\n                            {'fieldname': 'ht', 'fieldtype': 'HTML'},\n                        ],\n                        // primary_action: function(){\n                        //     d.hide();\n                        //     show_alert(d.get_values());\n                        // }\n                    });\n\n                    frappe.call({\n                        method: \"erpnext_ocr.erpnext_ocr.xml_reader.read\",\n                        args: {\n                            \"ocr_receipt\": cur_frm.doc.ocr_receipt\n                        },\n                        callback: function (r, rt) {\n                            console.log(r);\n                            var html = \"\";\n                            html += \"<div class='row'><div class='col-xs-2'>\" +\n                                \"<b>Source: </b></div><div class='col-xs-5'>\" +\n                                \"<input type='text' id='p1' value='\" + r.message['source'] + \"' class='form-check-input'></div>\" +\n                                \"<div class='col-xs-3'><button id='bt1' class='btn btn-primary'>Copy Text</button></div></div>\";\n\n\n                            html += \"<br><div class='row'> <div class='col-xs-2'><b>Vendor Name: </b></div>\" +\n                                \"<div class='col-xs-5'> <input type='text' id='p2' value='\" + r.message['vendor_name'] + \"' class='form-check-input'></div>\" +\n                                \"<div class='col-xs-3'> <button id='bt2' class='btn btn-primary'>Copy Text</button></div></div>\";\n\n\n                            // html += \"<br><b>Vendor Address: </b><input type='text' id='p3' value='\" + r.message['vendor_address'] + \"'><button id='bt3'>Copy Text</button>\";\n                            // html += \"<br><b>Invoice Date: </b><input type='text' id='p4' value='\" + r.message['invoice_date'] + \"'><button id='bt4'>Copy Text</button>\";\n                            // html += \"<br><b>Sub Total: </b><input type='text' id='p5' value='\" + r.message['subTotal'] + \"'><button id='bt5'>Copy Text</button>\";\n                            // html += \"<br><b>Payment Value: </b><input type='text' id='p6' value='\" + r.message['payment_val'] + \"'><button id='bt6'>Copy Text</button>\";\n\n                              html += \"<br><div class='row'> <div class='col-xs-2'><b>Vendor Address: </b></div>\" +\n                                \"<div class='col-xs-5'> <input type='text' id='p3' value='\" + r.message['vendor_address'] + \"' class='form-check-input'></div>\" +\n                                \"<div class='col-xs-3'> <button id='bt3' class='btn btn-primary'>Copy Text</button></div></div>\";\n\n                             html += \"<br><div class='row'> <div class='col-xs-2'><b>Invoice Date: </b></div>\" +\n                                \"<div class='col-xs-5'> <input type='text' id='p4' value='\" + r.message['invoice_date'] + \"' class='form-check-input'></div>\" +\n                                \"<div class='col-xs-3'> <button id='bt4' class='btn btn-primary'>Copy Text</button></div></div>\";\n\n                                      html += \"<br><div class='row'> <div class='col-xs-2'><b>Sub Total: </b></div>\" +\n                                \"<div class='col-xs-5'> <input type='text' id='p5' value='\" + r.message['subTotal'] + \"' class='form-check-input'></div>\" +\n                                \"<div class='col-xs-3'> <button id='bt5' class='btn btn-primary'>Copy Text</button></div></div>\";\n\n                                 html += \"<br><div class='row'> <div class='col-xs-2'><b>Payment Value: </b></div>\" +\n                                \"<div class='col-xs-5'> <input type='text' id='p6' value='\" + r.message['payment_val'] + \"' class='form-check-input'></div>\" +\n                                \"<div class='col-xs-3'> <button id='bt6' class='btn btn-primary'>Copy Text</button></div></div>\";\n\n                            html += \"<br><br><b>Recognized Items: </b>\";\n                            //ITEMS\n                            for (var i = 0; i < r.message['items'].length; i++) {\n                                console.log(i);\n                                // html += \"<br><b>Item Name: </b><input type='text' id='p7_\" + i + \"' value='\" + r.message['items'][i]['item_code'] + \"'><button id='bt7_\" + i + \"'>Copy Text</button>\";\n                                // html += \"<br><b>Qty.: </b><input type='text' id='p7_\" + i + \"' value='\" + r.message['items'][i]['qty'] + \"'><button id='bt7_\" + i + \"'>Copy Text</button>\";\n                                // html += \"<br><b>Amount: </b><input type='text' id='p7_\" + i + \"' value='\" + r.message['items'][i]['total'] + \"'><button id='bt7_\" + i + \"'>Copy Text</button><br>\";\n\n\n                                 html += \"<br><div class='row'> <div class='col-xs-2'><b>Name: </b></div>\" +\n                                \"<div class='col-xs-5'> \" +\n                                     \"<input type='text' id='p7_\" + (i).toString() + \"' value='\" + r.message['items'][i]['item_code'] + \"' class='form-check-input'></div>\" +\n                                \"<div class='col-xs-3'> <button id='bt7_\" + (i).toString() +\"' class='btn btn-primary'>Copy Text</button></div></div>\";\n\n                                 html += \"<div class='row'> <div class='col-xs-2'><b>Qty.: </b></div>\" +\n                                \"<div class='col-xs-5'> \" +\n                                     \"<input type='text' id='p8_\" + (i).toString() + \"' value='\" + r.message['items'][i]['qty'] + \"' class='form-check-input'></div>\" +\n                                \"<div class='col-xs-3'> <button id='bt8_\" + (i).toString() +\"' class='btn btn-primary'>Copy Text</button></div></div>\";\n\n                                 html += \"<div class='row'> <div class='col-xs-2'><b>Amount: </b></div>\" +\n                                \"<div class='col-xs-5'> \" +\n                                     \"<input type='text' id='p9_\" + (i).toString() + \"' value='\" + r.message['items'][i]['total'] + \"' class='form-check-input'></div>\" +\n                                \"<div class='col-xs-3'> <button id='bt9_\" + (i).toString() +\"' class='btn btn-primary'>Copy Text</button></div></div>\";\n\n\n                            }\n                            console.log(html);\n\n                            d.fields_dict.ht.$wrapper.html(html);\n                            d.show();\n                            document.getElementById(\"bt1\").addEventListener(\"click\", function () {\n                                    copyToClipboard(\"p1\");\n                                }\n                                , false);\n\n\n                            document.getElementById(\"bt2\").addEventListener(\"click\", function () {\n                                    copyToClipboard(\"p2\");\n                                }\n                                , false);\n\n\n                            document.getElementById(\"bt3\").addEventListener(\"click\", function () {\n                                    copyToClipboard(\"p3\");\n                                }\n                                , false);\n\n\n                            document.getElementById(\"bt4\").addEventListener(\"click\", function () {\n                                    copyToClipboard(\"p4\");\n                                }\n                                , false);\n\n\n                            document.getElementById(\"bt5\").addEventListener(\"click\", function () {\n                                    copyToClipboard(\"p5\");\n                                }\n                                , false);\n\n                            document.getElementById(\"bt6\").addEventListener(\"click\", function () {\n                                    copyToClipboard(\"p6\");\n                                }\n                                , false);\n\n                            var ii, bb, pp;\n                            for (ii = 0; ii < r.message['items'].length; ii++) {\n                                (function () {\n                                    console.log(ii);\n                                    var j = ii;\n                                    var bb = \"bt7_\" + (j).toString();\n                                    var pp = \"p7_\" + (j).toString();\n                                    console.log(bb);\n                                    console.log(pp);\n\n                                    document.getElementById(bb).addEventListener(\"click\", function () {\n                                            copyToClipboard(pp);\n                                        }\n                                        , false);\n\n                                    document.getElementById(\"bt8_\" + (j).toString()).addEventListener(\"click\", function () {\n                                            copyToClipboard(\"p8_\" + (j).toString());\n                                        }\n                                        , false);\n\n                                    document.getElementById(\"bt9_\" + (j).toString()).addEventListener(\"click\", function () {\n                                            copyToClipboard(\"p9_\" + (j).toString());\n                                        }\n                                        , false);\n                               }());\n                            }\n\n                            // document.getElementById('bt7_0').addEventListener(\"click\", function () {\n                            //             copyToClipboard('p7_0');\n                            //         }\n                            //         , false);\n\n\n\n                        }\n\n                    });\n                }\n                else\n                {\n                    frappe.msgprint(\"Please select OCR Receipt first.\");\n                }\n\n            }).addClass(\"btn-primary\")\n\n    }\n\n});", 
  "script_type": "Client"
 }
]